ggplot(dat, aes(x = VapingQuestionnaireScore)) +
geom_histogram(binwidth = 10) +
theme_bw()
qqPlot(x = dat$VapingQuestionnaireScore)
ggplot(dat, aes(x = IAT_RT)) +
geom_histogram(binwidth = 10) +
theme_bw()
qqPlot(x = dat$IAT_RT)
ggplot(dat, aes(x = IAT_RT, y = VapingQuestionnaireScore)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
theme_bw() +
labs(x = "Implicit attitude", y = "Explicit attitude")
results <- cor.test(dat$VapingQuestionnaireScore,
dat$IAT_RT,
method = "pearson") %>%
tidy()
results
correlation <- results %>%
pull(estimate) %>%
round(2)
df <- results %>%
pull(parameter) %>%
round(0)
pvalue <- results %>%
pull(p.value) %>%
round(3)
dat_matrix <- dat %>%
select(Age, IAT_RT, VapingQuestionnaireScore) %>%
as.data.frame() # Make sure tell R that dat is a data frame
pairs(dat_matrix)
intercor_results <- correlate(x = dat_matrix, # our data
test = TRUE, # compute p-values
corr.method = "spearman", # run a spearman test
p.adjust.method = "bonferroni") # use the bonferroni correction
intercor_results
?qqPlot
knitr::opts_chunk$set(echo = TRUE)
library(broom)
library(car)
library(tidyverse)
stars <- read_csv("stars2.csv")
engage <- read_csv("psess.csv")
head(stars) # Look at the data frames
head(engage)
stars_means <- stars %>%
group_by(ID) %>%
summarise(mean_anxiety = mean(Score, na.rm = TRUE))
stars_means
joined <- inner_join(stars_means, engage, "ID")
descriptives <- joined %>%
summarise(mean_anx = mean(mean_anxiety, na.rm = TRUE),
sd_anx = sd(mean_anxiety, na.rm = TRUE),
mean_weeks = mean(n_weeks, na.rm = TRUE),
sd_weeks = sd(n_weeks, na.rm = TRUE))
descriptives
length(joined$mean_anxiety)
length(joined$n_weeks)
ggplot(joined, aes(x = mean_anxiety, y = n_weeks)) +
geom_point() +
geom_smooth(method = "lm") +
labs(x = "Anxiety", y = "Engagement") +
theme_bw()
summarise(sd = sd(mean_anxiety), stars_means)
summarise(sd = sd(mean_anxiety), joined)
?mean
?qplot
libary(car)
library(car)
?qPlot
??qPlot
install.packages("shiny")
install.packages("learnr")
library(shiny)
library(ggplot2)
# User Interface (UI)
ui <- fluidPage(
titlePanel("t-Distribution vs. Normal Distribution (Degrees of Freedom Illustration)"),
sidebarLayout(
sidebarPanel(
sliderInput("df",
"Degrees of Freedom (df):",
min = 1,
max = 30,
value = 5)
),
mainPanel(
plotOutput("tPlot")
)
)
)
# Server logic
server <- function(input, output) {
output$tPlot <- renderPlot({
# Generate data for the plot
x_range <- seq(-4, 4, length = 500)
normal_density <- dnorm(x_range)
t_density <- dt(x_range, df = input$df) # Uses the input df value
# Create a data frame for ggplot
plot_data <- data.frame(
x = x_range,
Normal = normal_density,
T_dist = t_density
)
# Plot the distributions
ggplot(plot_data, aes(x = x)) +
geom_line(aes(y = Normal, color = "Normal Distribution"), linetype = "dashed", linewidth = 1) +
geom_line(aes(y = T_dist, color = "t-Distribution"), linewidth = 1.5) +
labs(title = paste("t-Distribution with df =", input$df),
y = "Density",
color = "Distribution") +
scale_color_manual(values = c("Normal Distribution" = "black", "t-Distribution" = "red")) +
theme_minimal()
})
}
# Run the application
shinyApp(ui = ui, server = server)
knitr::opts_chunk$set(echo = TRUE)
library(broom)
# Step 2: Load packages ---------------------------------------------------
## We'll need the following packages:
library(broom)
library(car)
library(lsr)
library(Hmisc)
library(tidyverse)
# Step 3: Read in the data ----------------------------------------------
dat <- read_csv("VapingData.csv")
# Step 1: Set your working directory --------------------------------------
getwd()
setwd("~/stats/year1/PSYC122/data/week12")
# Step 3: Read in the data ----------------------------------------------
dat <- read_csv("VapingData.csv")
# Step 4: Data wrangling --------------------------------------------------
dat <- dat %>%
filter(IAT_BLOCK3_Acc < 1) %>%                            # 1) only keep participants with accuracy scores equal to or smaller than 1 from block 3
filter(IAT_BLOCK5_Acc < 1) %>%                            # 1) only keep participants with accuracy scores equal to or smaller than 1 from block 5
mutate(IAT_ACC = (IAT_BLOCK3_Acc + IAT_BLOCK5_Acc)/2) %>% # 2) calculate an average IAT accuracy score across blocks 3 and 5
filter(IAT_ACC > .8) %>%                                  # 2) only keep participants with an average score greater than .8.
mutate(IAT_RT = IAT_BLOCK5_RT - IAT_BLOCK3_RT)            # 3) compute the IAT_RT score
descriptives <- dat %>%
summarise(n = n(),
mean_IAT_ACC = mean(IAT_ACC),
mean_IAT_RT = mean(IAT_RT),
mean_VPQ = mean(VapingQuestionnaireScore, na.rm = TRUE))
# Missing data
dat <- dat %>%
filter(!is.na(VapingQuestionnaireScore)) %>%
filter(!is.na(IAT_RT))
# Normality
ggplot(dat, aes(x = VapingQuestionnaireScore)) +
geom_histogram(binwidth = 10) +
theme_bw()
qqPlot(x = dat$VapingQuestionnaireScore)
ggplot(dat, aes(x = IAT_RT)) +
geom_histogram(binwidth = 10) +
theme_bw()
qqPlot(x = dat$IAT_RT)
# Linearity and homoscedasticity
ggplot(dat, aes(x = IAT_RT, y = VapingQuestionnaireScore)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
theme_bw() +
labs(x = "Implicit attitude", y = "Explicit attitude")
# Step 7: Conduct a correlation analysis ----------------------------------
results <- cor.test(dat$VapingQuestionnaireScore,
dat$IAT_RT,
method = "pearson") %>%
tidy()
results
correlation <- results %>%
pull(estimate) %>%
round(2)
df <- results %>%
pull(parameter) %>%
round(0)
pvalue <- results %>%
pull(p.value) %>%
round(3)
# Create a new data frame that only include the relevant variables
dat_matrix <- dat %>%
select(Age, IAT_RT, VapingQuestionnaireScore) %>%
as.data.frame() # Make sure tell R that dat is a data frame
# Create a matrix of scatterplots
pairs(dat_matrix)
# Conduct intercorrelation (multiple correlations)
intercor_results <- correlate(x = dat_matrix, # our data
test = TRUE, # compute p-values
corr.method = "spearman", # run a spearman test
p.adjust.method = "bonferroni") # use the bonferroni correction
intercor_results
# Normality
histogramVapingQS <- ggplot(dat, aes(x = VapingQuestionnaireScore)) +
geom_histogram(binwidth = 10) +
theme_bw()
histogramVapingQS
?facet_wrap
?qqplot
# Step 2: Load packages ---------------------------------------------------
## We'll need the following packages:
library(broom)
library(car)
library(lsr)
library(Hmisc)
library(tidyverse)
# Step 3: Read in the data ----------------------------------------------
dat <- read_csv("VapingData.csv")
setwd("~/stats/year1/PSYC122")
# Step 3: Read in the data ----------------------------------------------
dat <- read_csv("VapingData.csv")
setwd("~/stats/year1/PSYC122/data/week12")
# Step 2: Load packages ---------------------------------------------------
## We'll need the following packages:
library(broom)
library(car)
library(lsr)
library(Hmisc)
library(tidyverse)
# Step 3: Read in the data ----------------------------------------------
dat <- read_csv("VapingData.csv")
# Step 4: Data wrangling --------------------------------------------------
dat <- dat %>%
filter(IAT_BLOCK3_Acc < 1) %>%                            # 1) only keep participants with accuracy scores equal to or smaller than 1 from block 3
filter(IAT_BLOCK5_Acc < 1) %>%                            # 1) only keep participants with accuracy scores equal to or smaller than 1 from block 5
mutate(IAT_ACC = (IAT_BLOCK3_Acc + IAT_BLOCK5_Acc)/2) %>% # 2) calculate an average IAT accuracy score across blocks 3 and 5
filter(IAT_ACC > .8) %>%                                  # 2) only keep participants with an average score greater than .8.
mutate(IAT_RT = IAT_BLOCK5_RT - IAT_BLOCK3_RT)            # 3) compute the IAT_RT score
descriptives <- dat %>%
summarise(n = n(),
mean_IAT_ACC = mean(IAT_ACC),
mean_IAT_RT = mean(IAT_RT),
mean_VPQ = mean(VapingQuestionnaireScore, na.rm = TRUE))
# Missing data
dat <- dat %>%
filter(!is.na(VapingQuestionnaireScore)) %>%
filter(!is.na(IAT_RT))
# Normality
histogramVapingQS <- ggplot(dat, aes(x = VapingQuestionnaireScore)) +
geom_histogram(binwidth = 10) +
theme_bw()
histogramVapingQS
qqPlot(x = dat$VapingQuestionnaireScore)
ggplot(dat, aes(x = IAT_RT)) +
geom_histogram(binwidth = 10) +
theme_bw()
qqPlot(x = dat$IAT_RT)
# Linearity and homoscedasticity
ggplot(dat, aes(x = IAT_RT, y = VapingQuestionnaireScore)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
theme_bw() +
labs(x = "Implicit attitude", y = "Explicit attitude")
# Step 7: Conduct a correlation analysis ----------------------------------
results <- cor.test(dat$VapingQuestionnaireScore,
dat$IAT_RT,
method = "pearson") %>%
tidy()
results
correlation <- results %>%
pull(estimate) %>%
round(2)
df <- results %>%
pull(parameter) %>%
round(0)
pvalue <- results %>%
pull(p.value) %>%
round(3)
# Create a new data frame that only include the relevant variables
dat_matrix <- dat %>%
select(Age, IAT_RT, VapingQuestionnaireScore) %>%
as.data.frame() # Make sure tell R that dat is a data frame
# Create a matrix of scatterplots
pairs(dat_matrix)
# Conduct intercorrelation (multiple correlations)
intercor_results <- correlate(x = dat_matrix, # our data
test = TRUE, # compute p-values
corr.method = "spearman", # run a spearman test
p.adjust.method = "bonferroni") # use the bonferroni correction
intercor_results
# Step 3: Read in the data ----------------------------------------------
dat <- read_csv("VapingData.csv")
dat <- dat %>%
filter(IAT_BLOCK3_Acc < 1)
dat <- dat %>%
filter(IAT_BLOCK3_Acc < 1) %>%                            # 1) only keep participants with accuracy scores equal to or smaller than 1 from block 3
filter(IAT_BLOCK5_Acc < 1)
# Step 4: Data wrangling --------------------------------------------------
dat <- dat %>%
filter(IAT_BLOCK3_Acc < 1) %>%                            # 1) only keep participants with accuracy scores equal to or smaller than 1 from block 3
filter(IAT_BLOCK5_Acc < 1) %>%                            # 1) only keep participants with accuracy scores equal to or smaller than 1 from block 5
mutate(IAT_ACC = (IAT_BLOCK3_Acc + IAT_BLOCK5_Acc)/2) %>% # 2) calculate an average IAT accuracy score across blocks 3 and 5
filter(IAT_ACC > .8) %>%                                  # 2) only keep participants with an average score greater than .8.
mutate(IAT_RT = IAT_BLOCK5_RT - IAT_BLOCK3_RT)            # 3) compute the IAT_RT score
descriptives <- dat %>%
summarise(n = n(),
mean_IAT_ACC = mean(IAT_ACC),
mean_IAT_RT = mean(IAT_RT),
mean_VPQ = mean(VapingQuestionnaireScore, na.rm = TRUE))
descriptives <- dat %>%
summarise(sampleSize = n(),
mean_IAT_ACC = mean(IAT_ACC),
mean_IAT_RT = mean(IAT_RT),
mean_VPQ = mean(VapingQuestionnaireScore, na.rm = TRUE))
?n
# Step 1: Load packages ---------------------------------------------------
library(broom)
library(car)
library(tidyverse)
# Step 2: Read in the data ------------------------------------------------
stars <- read_csv("stars2.csv")
setwd("~/stats/year1/PSYC122/data/week13")
# Step 2: Read in the data ------------------------------------------------
stars <- read_csv("stars2.csv")
engage <- read_csv("psess.csv")
starsWeb <- download.file("https://github.com/lu-psy-r/statistics_for_psychologists/blob/main/PSYC122/data/week13/stars2.csv?raw=true", destfile = "stars2.csv")
# Step 1: Load packages ---------------------------------------------------
library(broom)
library(car)
library(tidyverse)
stars2 <- download.file("https://github.com/lu-psy-r/statistics_for_psychologists/blob/main/PSYC122/data/week13/stars2.csv?raw=true", destfile = "stars2.csv")
stars2
# Step 1: Load packages ---------------------------------------------------
library(broom)
library(car)
library(tidyverse)
# Step 2: Read in the data ------------------------------------------------
stars <- read_csv("stars2.csv")
setwd("~/stats/year1/PSYC122")
setwd("~/stats/year1/PSYC122/data/week13")
# Step 2: Read in the data ------------------------------------------------
stars <- read_csv("stars2.csv")
#stars2 <- download.file("https://github.com/lu-psy-r/statistics_for_psychologists/blob/main/PSYC122/data/week13/stars2.csv?raw=true", destfile = "stars2.csv")
engage <- read_csv("psess.csv")
head(stars) # Look at the data frames
head(engage)
# Step 3: Calculate mean anxiety scores ------------------------------
stars_means <- stars %>%
group_by(ID) %>%
summarise(mean_anxiety = mean(Score, na.rm = TRUE))
# Join dataframes -------------------------------------------
joined <- inner_join(stars_means, engage, "ID")
# Step 4: Calculate descriptive statistics ----------------------------------
descriptives <- joined %>%
summarise(mean_anx = mean(mean_anxiety, na.rm = TRUE),
sd_anx = sd(mean_anxiety, na.rm = TRUE),
mean_weeks = mean(n_weeks, na.rm = TRUE),
sd_weeks = sd(n_weeks, na.rm = TRUE))
# Step 5: Visualise the data ------------------------------------------------
ggplot(joined, aes(x = mean_anxiety, y = n_weeks)) +
geom_point() +
geom_smooth(method = "lm") +
labs(x = "Anxiety", y = "Engagement") +
theme_bw()
# Step 5: Visualise the data ------------------------------------------------
ggplot(joined, aes(x = mean_anxiety, y = n_weeks)) +
geom_point() +
geom_smooth(method = "lm") +
labs(x = "Anxiety", y = "Engagement") +
theme_bw() +
xlim(0,4)
# Step 5: Visualise the data ------------------------------------------------
ggplot(joined, aes(x = mean_anxiety, y = n_weeks)) +
geom_point() +
geom_smooth(method = "lm") +
labs(x = "Anxiety", y = "Engagement") +
theme_bw() +
xlim(0,4) +
ylim(0,10)
setwd("~/stats/year1/PSYC122/data/week13")
# Step 1: Load packages ---------------------------------------------------
library(broom)
library(car)
library(tidyverse)
# Step 2: Read in the data ------------------------------------------------
stars <- read_csv("stars2.csv")
View(stars)
#stars2 <- download.file("https://github.com/lu-psy-r/statistics_for_psychologists/blob/main/PSYC122/data/week13/stars2.csv?raw=true", destfile = "stars2.csv")
engage <- read_csv("psess.csv")
head(stars) # Look at the data frames
head(engage)
# Step 3: Calculate mean anxiety scores ------------------------------
stars_means <- stars %>%
group_by(ID) %>%
summarise(mean_anxiety = mean(Score, na.rm = TRUE))
View(stars_means)
# Join dataframes -------------------------------------------
joined <- inner_join(stars_means, engage, "ID")
# Join dataframes -------------------------------------------
joined <- inner_join(stars_means, engage)
# Step 4: Calculate descriptive statistics ----------------------------------
descriptives <- joined %>%
summarise(mean_anx = mean(mean_anxiety, na.rm = TRUE),
sd_anx = sd(mean_anxiety, na.rm = TRUE),
mean_weeks = mean(n_weeks, na.rm = TRUE),
sd_weeks = sd(n_weeks, na.rm = TRUE))
View(descriptives)
descriptives
ggplot(joined, aes(x = mean_anxiety, y = n_weeks)) +
geom_point() +
geom_smooth(method = "lm")
# Step 5: Visualise the data ------------------------------------------------
ggplot(joined, aes(x = mean_anxiety, y = n_weeks)) +
geom_point() +
geom_smooth(method = "lm") +
labs(x = "Anxiety", y = "Engagement") +
theme_bw() +
#  xlim(0,4) +
#  ylim(0,10)
# Step 6: Build the regression model -----------------------------------------------
mod <- lm(n_weeks ~ mean_anxiety, data = joined)
# Step 5: Visualise the data ------------------------------------------------
ggplot(joined, aes(x = mean_anxiety, y = n_weeks)) +
geom_point() +
geom_smooth(method = "lm") +
labs(x = "Anxiety", y = "Engagement") +
theme_bw() +
#  xlim(0,4) +
#  ylim(0,10)
# Step 6: Build the regression model -----------------------------------------------
mod <- lm(n_weeks ~ mean_anxiety, data = joined)
ggplot(joined, aes(x = mean_anxiety, y = n_weeks)) +
geom_point() +
geom_smooth(method = "lm") +
labs(x = "Anxiety", y = "Engagement") +
theme_bw()
# Step 5: Visualise the data ------------------------------------------------
ggplot(joined, aes(x = mean_anxiety, y = n_weeks)) +
geom_point() +
geom_smooth(method = "lm") +
labs(x = "Anxiety", y = "Engagement") +
theme_bw() +
#  xlim(0,4) +
#  ylim(0,10)
# Step 6: Build the regression model -----------------------------------------------
mod <- lm(n_weeks ~ mean_anxiety, data = joined)
mod_summary <- summary(mod)
# Step 6: Build the regression model -----------------------------------------------
mod <- lm(n_weeks ~ mean_anxiety, data = joined)
View(mod)
mod_summary <- summary(mod)
mod_summary
# Step 5: Visualise the data ------------------------------------------------
ggplot(joined, aes(x = mean_anxiety, y = n_weeks)) +
geom_point() +
geom_smooth(method = "lm") +
labs(x = "Anxiety", y = "Engagement") +
theme_bw() +
xlim(0,4) +
ylim(0,10)
# Step 5: Visualise the data ------------------------------------------------
ggplot(joined, aes(x = mean_anxiety, y = n_weeks)) +
geom_point() +
geom_smooth(method = "lm") +
labs(x = "Anxiety", y = "Engagement") +
theme_bw() #+
# Step 5: Visualise the data ------------------------------------------------
ggplot(joined, aes(x = mean_anxiety, y = n_weeks)) +
geom_point() +
#geom_smooth(method = "lm") +
labs(x = "Anxiety", y = "Engagement") +
theme_bw() #+
# Step 5: Visualise the data ------------------------------------------------
ggplot(joined, aes(x = mean_anxiety, y = n_weeks)) +
geom_point() +
geom_smooth(method = "lm") +
labs(x = "Anxiety", y = "Engagement") +
theme_bw() #+
# Step 7: Check the assumptions ----------------------------------------------------
crPlots(mod)                  # Plot linear line and line that best fits the data to check the relationship between outcome and predictor is linear
qqPlot(mod$residuals)         # Create qq-plot to check residuals are normally distributed
residualPlot(mod)             # Create residual plot to check residual show homoscedasticity
# Run this code to empty the R environment
rm(list=ls())
# Run this code to load relevant libraries
library("lsr")
library("tidyverse")
# Read in data and have a look at the tables
intent_data <- read_csv("RTA_study1.csv")                                 # Read in the data file
setwd("~/stats/year1/PSYC122/data/week14")
# Read in data and have a look at the tables
intent_data <- read_csv("RTA_study1.csv")                                 # Read in the data file
head(intent_data)                                                         # Look at the table
# Write the code
intent_recode <- intent_data %>%
filter(intend == 1) %>%
mutate(condition = recode(condition, "1" = "rta", "2" = "control"),
actualdonate = recode(actualdonate, "1" = "donated", "0" = "no_donation"))
head(intent_recode)
intent_percent <- intent_recode %>%
group_by(condition, actualdonate) %>%
count()
intent_percent
# Write the code
intent_counts <- intent_recode %>%
group_by(condition, actualdonate) %>%
count()
intent_counts
intent_percent <- intent_recode %>%
group_by(condition, actualdonate) %>%
count() %>%
#ungroup() %>% # ungroups the data
group_by(condition) %>% # then groups it again but just by condition
mutate(percent_condition = n/sum(n) * 100)
intent_percent
intent_percent <- intent_recode %>%
group_by(condition, actualdonate) %>%
count() %>%
ungroup() %>% # ungroups the data
group_by(condition) %>% # then groups it again but just by condition
mutate(percent_condition = n/sum(n) * 100)
intent_percent
?ungroup
